<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
	xmlns:regulation="urn:x-lexisnexis:content:regulation:sharedservices:1"
	xmlns:leg="http://www.lexis-nexis.com/glp/leg"
	xmlns:docinfo="http://www.lexis-nexis.com/glp/docinfo" xmlns:ci="http://www.lexis-nexis.com/ci"
	xmlns:lnci="http://www.lexisnexis.com/xmlschemas/content/shared/citations/1/"
	xmlns:ref="http://www.lexisnexis.com/xmlschemas/content/shared/reference/1/"
	xmlns:legisinfo="http://www.lexisnexis.com/xmlschemas/content/legal/legislation-info/1/"
	xmlns:primlaw="http://www.lexisnexis.com/xmlschemas/content/legal/primarylaw/1/"
	xmlns:primlawinfo="http://www.lexisnexis.com/xmlschemas/content/legal/primarylaw-info/1/"
	xmlns:dita="http://dita.oasis-open.org/architecture/2005/" version="2.0"
	exclude-result-prefixes="dita">

	<dita:topic xmlns="http://dita.oasis-open.org/architecture/2005/" id="Head">
		<title>Head <lnpid>id-CA06-13808</lnpid></title>
		<body>
			<section>
				<p><sourcexml>regulation:regulation/regulation:head</sourcexml> is created as
					described in the Introduction.</p>
			</section>
		</body>
	</dita:topic>

	<!--  @@@ This file has been autogenerated.  Remove this comment after manual development complete! @@@  -->
	<!--    Original DITA file location:  DITA\ConversionInstructions\Rosetta\DITA-CAN\CA06-Regulation\Head.dita  -->
	<!--<xsl:message>CA06-Regulation_Head.xsl requires manual development!</xsl:message> -->
	<!--	<xsl:include href="../../modules/leg/CA06-Regulation_leg.officialname.xsl"/>-->
	<xsl:template match="leg:info">
		<xsl:variable name="status_text"
			select="upper-case(/LEGDOC/leg:body/leg:info/leg:history[1]/leg:histnote/p/text)"/>
		<regulation:head>
			<!--  Original Target XPath:     -->
			<!--  Could not determine target element or attribute name:  <>  -->
			<xsl:apply-templates select="child::leg:num"/>
			<xsl:apply-templates select="child::leg:relatedleg"/>
			<xsl:apply-templates select="child::leg:officialnum[child::ci:cite]"/>
			<xsl:apply-templates select="child::leg:date"/>
			<xsl:if
				test="docinfo/docinfo:custom-metafields/docinfo:custom-metafield[@name = 'actFirstDoc'][contains(., 'true')][not(following::leg:officialnum[child::ci:cite])]">
				<ref:citations>
					<ref:cite4thisresource citetype="reporter">
						<lnci:cite>
							<lnci:content>
								<xsl:value-of
									select="child::leg:officialnum[not(child::ci:cite)][1]"/>
							</lnci:content>
						</lnci:cite>
					</ref:cite4thisresource>
					<ref:cite4thisresource>
						<lnci:cite type="act">
							<lnci:content>
								<xsl:value-of
									select="child::leg:officialnum[not(child::ci:cite)][1]"/>
							</lnci:content>
						</lnci:cite>
					</ref:cite4thisresource>
				</ref:citations>
			</xsl:if>
			<xsl:apply-templates select="child::leg:juris"/>
		</regulation:head>
		<regulation:body>
			<xsl:apply-templates select="child::leg:longtitle"/>
			<xsl:apply-templates select="following-sibling::leg:level"/>
			<xsl:if test="not(following-sibling::leg:level) and not(starts-with($status_text,'REPEALED BY') or starts-with($status_text,'ABROGÉ PAR') or starts-with($status_text,'ABROGÉE PAR'))">
				<primlaw:level leveltype="unclassified">
					<primlaw:levelinfo>
						<primlawinfo:primlawinfo>
							<legisinfo:legisinfo>
								<legisinfo:statusgroup>
									<legisinfo:status statuscode="consolidated"/>
								</legisinfo:statusgroup>
							</legisinfo:legisinfo>
						</primlawinfo:primlawinfo>
					</primlaw:levelinfo>
				</primlaw:level>
			</xsl:if>
			<xsl:if test="not(following-sibling::leg:level) and starts-with($status_text,'REPEALED BY') or starts-with($status_text,'ABROGÉ PAR') or starts-with($status_text,'ABROGÉE PAR')">
				<primlaw:level leveltype="unclassified">
					<primlaw:levelinfo>
						<primlawinfo:primlawinfo>
							<legisinfo:legisinfo>
								<legisinfo:statusgroup>
									<legisinfo:status statuscode="repealedshell">
										<legisinfo:statustext>
											<xsl:value-of select="/LEGDOC/leg:body/leg:info/leg:history/leg:histnote/p/text"/>
										</legisinfo:statustext>
									</legisinfo:status>
								</legisinfo:statusgroup>
							</legisinfo:legisinfo>
						</primlawinfo:primlawinfo>
					</primlaw:levelinfo>
				</primlaw:level>
			</xsl:if>
		</regulation:body>
	</xsl:template>

</xsl:stylesheet>

<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:dita="http://dita.oasis-open.org/architecture/2005/" xmlns:docinfo="http://www.lexis-nexis.com/glp/docinfo" xmlns:doc="http://www.lexisnexis.com/xmlschemas/content/shared/document-level-metadata/1/" xmlns:proc="http://www.lexisnexis.com/xmlschemas/content/shared/process-elements/1/" version="2.0" exclude-result-prefixes="dita docinfo">

	<dita:topic xmlns="http://dita.oasis-open.org/architecture/2005/" id="LPA-PracticalGuidance-alt.rendition_link_with_ezform">
    <title><sourcexml>docinfo:alt-renditions/docinfo:alt-rendition/link</sourcexml> containing "EZ" and "Form" <lnpid>id-NZ11-24607</lnpid></title>
    <body>
        <section>
        <p>If a <sourcexml>link</sourcexml> element within
          <sourcexml>docinfo:alt-renditions/docinfo:alt-rendition</sourcexml> has
          <sourcexml>link/@type="wordprocess"</sourcexml>
        <b><u>and</u></b> its content has both the word "EZ" and the word "Form" without regard to
        upper/lower case (compare with case insensitive), then an additional
          <targetxml>proc:param</targetxml> element with attributes
          <targetxml>proc:param/@name="attachment-subtype"</targetxml> and
          <targetxml>proc:param/@value="ezform"</targetxml> is output as a child of
          <targetxml>doc:alt-rendition/ref:lnlink/ref:locator/ref:locator-parms</targetxml>. This
          <targetxml>proc:param</targetxml> element is output only in this scenario, and when this
        scenario occurs it is output <b><u>in addition</u></b> to any other
          <targetxml>proc:param</targetxml> elements and other elements that are output in general
        for the <sourcexml>link</sourcexml> element. </p>
        </section>
    <section>
      <title>Source XML</title>
      <codeblock>

&lt;docinfo:alt-renditions&gt;
  &lt;docinfo:alt-rendition&gt;
    &lt;link type="wordprocess" filename="nzpg-16-5-orig-app-sp-asts.doc"&gt;Download this Newsletter in Word format&lt;/link&gt;
  &lt;/docinfo:alt-rendition&gt;
  &lt;docinfo:alt-rendition&gt;
    &lt;link type="wordprocess" filename="nzpg-ez-16-5-orig-app-sp-asts.doc"&gt;EZ Form format&lt;/link&gt;
  &lt;/docinfo:alt-rendition&gt;
&lt;/docinfo:alt-renditions&gt;

      </codeblock>
    </section>
    <section>
      <title>Target XML</title>
      <codeblock>

&lt;doc:alt-renditions&gt;
  &lt;doc:alt-rendition&gt;
    &lt;ref:lnlink service="ATTACHMENT"&gt;
      &lt;ref:marker role="label"&gt;Download this Newsletter in Word format&lt;/ref:marker&gt;
      &lt;ref:locator&gt;
        &lt;ref:locator-key&gt;
          &lt;ref:key-name name="attachment-key"/&gt;
          &lt;ref:key-value value="LNI_NUMBER-SMI_NUMBER-nzpg-16-5-orig-app-sp-asts"/&gt;
        &lt;/ref:locator-key&gt;
        &lt;ref:locator-params&gt;
          &lt;proc:param name="attachment-type" value="wordprocess"/&gt;
          &lt;proc:param name="componentseq" value="1"/&gt;
          &lt;proc:param name="attachment-smi" value="SMI_NUMBER"/&gt;
        &lt;/ref:locator-params&gt;
      &lt;/ref:locator&gt;
    &lt;/ref:lnlink&gt;
  &lt;/doc:alt-rendition&gt;
  &lt;doc:alt-rendition&gt;
    &lt;ref:lnlink service="ATTACHMENT"&gt;
      &lt;ref:marker role="label"&gt;EZ Form format&lt;/ref:marker&gt;
      &lt;ref:locator&gt;
        &lt;ref:locator-key&gt;
          &lt;ref:key-name name="attachment-key"/&gt;
          &lt;ref:key-value value="LNI_NUMBER-SMI_NUMBER-nzpg-ez-16-5-orig-app-sp-asts"/&gt;
        &lt;/ref:locator-key&gt;
        &lt;ref:locator-params&gt;
          &lt;proc:param name="attachment-type" value="wordprocess"/&gt;
          &lt;proc:param name="componentseq" value="1"/&gt;
          &lt;proc:param name="attachment-smi" value="SMI_NUMBER"/&gt;
          &lt;proc:param name="attachment-subtype" value="ezform"/&gt;
        &lt;/ref:locator-params&gt;
      &lt;/ref:locator&gt;
    &lt;/ref:lnlink&gt;
  &lt;/doc:alt-rendition&gt;
&lt;/doc:alt-renditions&gt;

      </codeblock>
    </section>
    <section>
      <title>Changes</title>
      <p>2013-11-05: <ph id="change_20131105_JCG">Added this new instruction. (Webteam
        #244273)</ph></p>
    </section>
    </body>
  	</dita:topic>

	<!--  @@@ This file has been autogenerated.  Remove this comment after manual development complete! @@@  -->
	<!--    Original DITA file location:  DITA\ConversionInstructions\Rosetta\DITA-PAC\NZ11_LNPG_seclaw\LPA-PracticalGuidance_rosetta_docinfo.alt-rendition_link_with_ezform.dita  -->
	<xsl:message>LPA-PracticalGuidance_rosetta_docinfo.alt-rendition_link_with_ezform.xsl requires manual development!</xsl:message> 

	<xsl:template match="docinfo:alt-renditions/docinfo:alt-rendition/link">

		<!--  Original Target XPath:  proc:param   -->
		<proc:param>
			<xsl:apply-templates select="@* | node()"/>
		</proc:param>

	</xsl:template>

	<xsl:template match="link">

		<!--  Original Target XPath:  proc:param   -->
		<proc:param>
			<xsl:apply-templates select="@* | node()"/>
		</proc:param>

	</xsl:template>

	<xsl:template match="docinfo:alt-renditions/docinfo:alt-rendition">

		<!--  Original Target XPath:  proc:param   -->
		<proc:param>
			<xsl:apply-templates select="@* | node()"/>
		</proc:param>

	</xsl:template>

	<xsl:template match="link/@type=&#34;wordprocess&#34;">

		<!--  Original Target XPath:  proc:param   -->
		<proc:param>
			<xsl:apply-templates select="@* | node()"/>
		</proc:param>

	</xsl:template>

</xsl:stylesheet>
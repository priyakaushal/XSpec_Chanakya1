<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:dita="http://dita.oasis-open.org/architecture/2005/" xmlns:contact="http://www.lexisnexis.com/xmlschemas/content/shared/contact/1/" version="2.0" exclude-result-prefixes="dita">

	<dita:topic xmlns="http://dita.oasis-open.org/architecture/2005/" id="common_rosetta_email">
    <title><sourcexml>email</sourcexml> to  <targetxml>email</targetxml> <lnpid>id-CCCC-10312</lnpid></title>  
    <body>
        <section>
            <title>Instructions <i>[common element]</i></title>
            <p><sourcexml>email</sourcexml> becomes <targetxml>contact:email</targetxml>.</p>
            <p>The attributes and content of <targetxml>contact:email</targetxml> are populated as follows: <ul>
                    <li>The value of <sourcexml>email/remotelink/@href</sourcexml> with the prefix "mailto:" should be placed in
                            <targetxml>contact:email/@normval</targetxml>.</li>
                    <li>The content of <sourcexml>email/remotelink</sourcexml> should be placed in <targetxml>contact:email</targetxml>.</li>
                </ul></p>
        </section>

        <example>
            <title>Source XML</title>
            <codeblock>

&lt;email&gt;
    &lt;remotelink href="rtu@services.nsw.gov.au" hrefclass="mailto"&gt;rtu@services.nsw.gov.au&lt;/remotelink&gt;
&lt;/email&gt;

	</codeblock>
        </example>

        <example>
            <title>Target XML</title>
            <codeblock>

&lt;contact:email normval="mailto:rtu@services.nsw.gov.au"&gt;rtu@services.nsw.gov.au
&lt;/contact:email&gt;

	</codeblock>
        </example>
        
        <section>
            <p>If <sourcexml>emph</sourcexml> occurs within <sourcexml>email/remotelink</sourcexml> then <sourcexml>emph</sourcexml> should be suppressed from conversion.</p>
        </section>
        
        <example>
            <title>Source XML</title>
            <codeblock>

&lt;email&gt;
    &lt;remotelink href="Oliver@simplychateau.com" hrefclass="mailto"&gt;
        &lt;emph typestyle="it"&gt;Oliver@simplychateau.com&lt;/emph&gt; 
    &lt;/remotelink&gt;
&lt;/email&gt;

	</codeblock>
        </example>
        
        <example>
            <title>Target XML</title>
            <codeblock>

&lt;contact:email normval="mailto:Oliver@simplychateau.com"&gt;
    Oliver@simplychateau.com
&lt;/contact:email&gt;

	</codeblock>
        </example>
        
        <section>
            <title>Changes</title>
            <p>2012-05-07: Created.</p>
            <p>2012-11-21: Added instruction and example for handling of <sourcexml>email/remotelink/emph</sourcexml>.</p>
        </section>
        
 

    </body>
	</dita:topic>

	<!--  @@@ This file has been autogenerated (although the DITA file already has embedded XSLT).  Remove this comment after manual development complete!  (also remove the embedded XSLT within the DITA above) @@@  -->
	<!--    Original DITA file location:  DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_email-LxAdv-email.dita  --> 

                <!-- CSN: Created mail template -->
                <xsl:template match="email">
                    <xsl:element name="contact:email">
                        <xsl:attribute name="normval">
                            <xsl:value-of select="./remotelink/@hrefclass"/>
                            <xsl:text>:</xsl:text>
                            <xsl:value-of select="./remotelink/@href"/>
                        </xsl:attribute>
                        <xsl:value-of select="string-join(remotelink , '')"/>
                    </xsl:element>
                </xsl:template>

    <!-- Vikas Rohilla : Added for the UK12   -->
    <xsl:template match="email[$streamID='UK12']">
        <xsl:element name="contact:email">
        <xsl:choose>
            <xsl:when test="child::remotelink">
                <xsl:attribute name="normval">
                    <xsl:value-of select="./remotelink/@hrefclass"/>
                    <xsl:text>:</xsl:text>
                    <xsl:value-of select="./remotelink/@href"/>
                </xsl:attribute>
                <xsl:value-of select="string-join(remotelink , '')"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:apply-templates select="@*|node()"/>
            </xsl:otherwise>
        </xsl:choose>
        </xsl:element>
    </xsl:template>
        
            
</xsl:stylesheet>
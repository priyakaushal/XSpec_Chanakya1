<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:dita="http://dita.oasis-open.org/architecture/2005/" xmlns:classify="http://www.lexisnexis.com/xmlschemas/content/shared/classification/1/" xmlns:regulation="urn:x-lexisnexis:content:regulation:sharedservices:1" version="2.0" exclude-result-prefixes="dita">

	<dita:topic xmlns="http://dita.oasis-open.org/architecture/2005/" id="refnum">
  <title>refnum <lnpid>id-UK07-28228</lnpid></title>
  <body>
    <section>
      <p><sourcexml>refnum</sourcexml> becomes
          <targetxml>regulation:head/primlawinfo:primlawinfo/classify:classification/@classscheme="uk-government-code"/classify:classitem/classify:classitem-identifier</targetxml>
        and create child elements <targetxml>classify:classname</targetxml> and
          <targetxml>classify:classcode</targetxml>. Where: <ul>
          <li>The value of the <targetxml>classify:classcode</targetxml> will have the value of
              <sourcexml>refnum</sourcexml></li>
          <li>The value of the <targetxml>classify:classname</targetxml> will be picked from the
            below mention pick list: <ul>
              <li><b>Commencement</b> : for <sourcexml>refnum</sourcexml> values of the form "(C
                n)", where <b>n</b> is integer value in <sourcexml>refnum</sourcexml></li>
              <li><b>Commencement (Welsh Language)</b> : for <sourcexml>refnum</sourcexml> values of
                the form "(Cy n)", where <b>n</b> is integer value in
                <sourcexml>refnum</sourcexml></li>
              <li><b>UK Legal Series</b> : for <sourcexml>refnum</sourcexml> values of the form "(L
                n)", where <b>n</b> is integer value in <sourcexml>refnum</sourcexml></li>
              <li><b>Scottish Legal Series</b> : for <sourcexml>refnum</sourcexml> values of the
                form "(S n)", where <b>n</b> is integer value in <sourcexml>refnum</sourcexml></li>
              <li><b>Welsh Legal Series</b> : for <sourcexml>refnum</sourcexml> values of the form
                "(W n)", where <b>n</b> is integer value in <sourcexml>refnum</sourcexml></li>
            </ul>
          </li>
        </ul>
        <note>If attribute <sourcexml>@refnumtype</sourcexml> inside <sourcexml>refnum</sourcexml>
          then <sourcexml>@refnumtype</sourcexml> will be suppressed from conversion.</note> And
        populated as below: </p>
      
      <pre>
&lt;refnum refnumtype="classification"&gt;  (C 71)&lt;/refnum&gt;

<b>Becomes</b>
        
&lt;regulation:head&gt;
    &lt;primlawinfo:primlawinfo&gt;
        &lt;classify:classification classscheme="uk-government-code"&gt;
            &lt;classify:classitem&gt;
                &lt;classify:classitem-identifier&gt;
                    &lt;classify:classname&gt;Commencement&lt;/classify:classname&gt;
                    &lt;classify:classcode&gt;  (C 71)&lt;/classify:classcode&gt;
                &lt;/classify:classitem-identifier&gt;
            &lt;/classify:classitem&gt;
        &lt;/classify:classification&gt;
    &lt;/primlawinfo:primlawinfo&gt;
&lt;/regulation:head&gt;
      </pre>
    </section>
    <section>
      <title>Changes</title>
      <p>2015-11-26: <ph id="change_20151126_AS">Updated target mapping of <sourcexml>refnum</sourcexml> to be mapped under <sourcexml>regulation:head</sourcexml>. RFA #2440</ph></p>
      <p>2015-10-29: <ph id="change_20151029_PS">Updated target mapping and example of
            <sourcexml>refnum</sourcexml> element. Applicable on UK07.</ph></p>
    </section>
  </body>
	</dita:topic>

	<!--  @@@ This file has been autogenerated.  Remove this comment after manual development complete! @@@  -->
	<!--    Original DITA file location:  DITA\ConversionInstructions\Rosetta\DITA-UK\UK07-Regulations\refnum.dita  -->

  <xsl:variable name="classname">
    <codes>
      <code key="C " value="Commencement"/>
      <code key="Cy " value="Commencement (Welsh Language)"/>
      <code key="L " value="UK Legal Series"/>
      <code key="S " value="Scottish Legal Series"/>
      <code key="W " value="Welsh Legal Series"/>
      
    </codes>
  </xsl:variable>
  <xsl:template match="refnum">

		<!--  Original Target XPath:  regulation:head/primlawinfo:primlawinfo/classify:classification/@classscheme="uk-government-code"/classify:classitem/classify:classitem-identifier   -->
    <classify:classification classscheme="uk-government-code">
      <classify:classitem>
        <classify:classitem-identifier>
          <xsl:variable name="spanValue" select="."/>
      <!--    <xsl:message>
            <xsl:value-of select="$spanValue"/>
          </xsl:message>-->
          <xsl:for-each select="$classname/codes/code">
            <xsl:variable name="code" select="."/>
            
            <xsl:if test="contains($spanValue, $code/@key)">
              <classify:classname>
                    <!--<xsl:value-of
                      select="replace($spanValue, $code/@key, $code/@value)"/>-->
                <xsl:value-of select="$code/@value"/>
              </classify:classname>
            </xsl:if>
          </xsl:for-each>
          
          <classify:classcode>
            <xsl:value-of select="."/>
          </classify:classcode>
          
        </classify:classitem-identifier>
      </classify:classitem>
    </classify:classification>

	</xsl:template>
	

</xsl:stylesheet>
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:dita="http://dita.oasis-open.org/architecture/2005/"
    xmlns:comm="http://www.lexis-nexis.com/glp/comm"
    xmlns:dict="urn:x-lexisnexis:content:dict:sharedservices:1"
    xmlns:tei="http://www.tei-c.org/ns/1.0/" version="2.0" exclude-result-prefixes="dita comm">

    <dita:topic xmlns="http://dita.oasis-open.org/architecture/2005/"
        id="CA12_CA-Dictionaries_comm_body">
        <title>comm:body <lnpid>id-CA12-15009</lnpid></title>

        <body>
            <p><sourcexml class="+ topic/keyword xml-d/sourcexml ">comm:body</sourcexml> becomes
                    <targetxml class="+ topic/keyword xml-d/targetxml "
                    >dict:dictionary/dict:body</targetxml>.</p>

            <pre xml:space="preserve" class="- topic/pre ">&lt;comm:body&gt;
    &lt;level leveltype="1"&gt;
        &lt;heading&gt;
            &lt;title&gt;
                &lt;defterm searchtype="DEFINED-TERMS"&gt;OFFEREE&lt;/defterm&gt;
            &lt;/title&gt;
        &lt;/heading&gt;
        &lt;level leveltype="3"&gt;
            ...
        &lt;/level&gt;
    &lt;/level&gt;
&lt;/comm:body&gt;

<b class="+ topic/ph hi-d/b ">Becomes</b>

&lt;dict:body&gt;
    &lt;dict:defitem&gt;
        &lt;tei:entry&gt;
            &lt;tei:form&gt;
                &lt;tei:orth&gt;OFFEREE&lt;/tei:orth&gt;
            &lt;/tei:form&gt;
            &lt;tei:def&gt;
                &lt;pgrp&gt;
                    ...
                &lt;/pgrp&gt;
            &lt;/tei:def&gt;
        &lt;/tei:entry&gt;
    &lt;/dict:defitem&gt;
&lt;/dict:body&gt;
</pre>
        </body>
    </dita:topic>

    <!--  @@@ This file has been autogenerated.  Remove this comment after manual development complete! @@@  -->
    <!--    Original DITA file location:  DITA\ConversionInstructions\Rosetta\DITA-CAN\CA12-Dictionaries\CA12_CA-Dictionaries_comm_body.dita  -->
    <!--<xsl:message>CA12_CA-Dictionaries_comm_body.xsl requires manual development!</xsl:message>-->

    <xsl:template match="comm:body">
        <!--  Original Target XPath:  dict:dictionary/dict:body   -->

        <dict:defitem>
            <xsl:choose>
                <xsl:when test="child::level[@leveltype = '1'][parent::comm:body[1]]">
                    <xsl:apply-templates
                        select="child::level[@leveltype = '1'][parent::comm:body[1]]"/>
                </xsl:when>
                <xsl:when test="child::level[@leveltype = '3'][parent::comm:body[1]]">
                    <tei:entry>
                        <xsl:apply-templates select="level[@leveltype = '3']" mode="level3"/>
                    </tei:entry>
                </xsl:when>
                <xsl:otherwise>
                    <xsl:message>unexcepted data</xsl:message>
                </xsl:otherwise>
            </xsl:choose>

        </dict:defitem>

        <xsl:apply-templates select=".//references"/>
    </xsl:template>

</xsl:stylesheet>

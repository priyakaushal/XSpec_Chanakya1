<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:dita="http://dita.oasis-open.org/architecture/2005/"
    xmlns:leg="http://www.lexis-nexis.com/glp/leg" 
    xmlns:ci="http://www.lexis-nexis.com/ci" xmlns:docinfo="http://www.lexis-nexis.com/glp/docinfo"
    xmlns:ref="http://www.lexisnexis.com/xmlschemas/content/shared/reference/1/"
    xmlns:regulation="urn:x-lexisnexis:content:regulation:sharedservices:1" version="2.0"
    exclude-result-prefixes="dita ci docinfo">

    <dita:topic xmlns="http://dita.oasis-open.org/architecture/2005/" id="head">
        <title>head <lnpid>id-UK07-28207</lnpid></title>
        <body>
            <section>
                <p><targetxml>regulation:regulation/regulation:head</targetxml> is created as
                    described in the Introduction.</p>
                <p><sourcexml>docinfo:normcite/ci:cite/ci:content</sourcexml> becomes
                        <targetxml>regulation:head/ref:citations/ref:cite4thisresource[@citetype]/ref:nonciteidentifier/[@normprotocol]</targetxml>
                    and attribute's value should be set as:</p>
                <ul>
                    <li><targetxml>ref:cite4thisresource[@citetype="normcite"]</targetxml></li>
                    <li><targetxml>ref:nonciteidentifier[@normprotocol="unspecified"]</targetxml></li>
                </ul> And populated as below: <pre>

&lt;docinfo:normcite&gt;
    &lt;ci:cite type="cite4thisdoc"&gt;
        &lt;ci:content&gt;1266_4a&lt;/ci:content&gt;
    &lt;/ci:cite&gt;
&lt;/docinfo:normcite&gt;

<b>Becomes</b>
        

&lt;regulation:head&gt;
    &lt;ref:citations&gt;
        &lt;ref:cite4thisresource citetype="normcite"&gt;
            &lt;ref:nonciteidentifier normprotocol="unspecified"&gt;1266_4a&lt;/ref:nonciteidentifier&gt;
        &lt;/ref:cite4thisresource&gt;
    &lt;/ref:citations&gt;
&lt;/regulation:head&gt;

      </pre>
                <note> If <sourcexml>docinfo:normcite/ci:cite/@type="cite4thisdoc"</sourcexml> and
                        <sourcexml>docinfo:normcite/ci:cite/@type="parallel"</sourcexml> then it
                    will be mapped as
                        <targetxml>ref:citations/ref:cite4thisresource[@citetype="parallel"]/ref:nonciteidentifier/[@normprotocol="unspecified"
                        @CITE-DEF]</targetxml> For more clarification please refer the
                    example.</note>
                <pre>
&lt;docinfo:normcite&gt;
    &lt;ci:cite type="cite4thisdoc"&gt;
        &lt;ci:content&gt;UK_SI 1994 2507 SECT 33&lt;/ci:content&gt;
    &lt;/ci:cite&gt;
    &lt;ci:cite type="parallel"&gt;
        &lt;ci:content&gt;UK_SI 1994 2507 PART 5&lt;/ci:content&gt;
    &lt;/ci:cite&gt;
&lt;/docinfo:normcite&gt;
      
      
<b>Becomes</b>

&lt;ref:citations&gt;        
    &lt;ref:cite4thisresource citetype="normcite"&gt;
        &lt;ref:nonciteidentifier normprotocol="unspecified" CITE-DEF="#600505#a21#1994#000000000002507##872# 33#"&gt;UK_SI 1994 2507 SECT 33&lt;/ref:nonciteidentifier&gt;
    &lt;/ref:cite4thisresource&gt;
    &lt;ref:cite4thisresource citetype="parallel"&gt;
        &lt;ref:nonciteidentifier normprotocol="unspecified" CITE-DEF="#600505#a21#1994#000000000002507##1467# 5#"&gt;UK_SI 1994 2507 PART 5&lt;/ref:nonciteidentifier&gt;
    &lt;/ref:cite4thisresource&gt;
&lt;/ref:citations&gt;   

    </pre>
            </section>
            <section>
                <title>Changes</title>
                <p>2016-10-12: <ph id="change_20161012_AS">Added instruction for handling input
                            <sourcexml>ci:cite/@type="cite4thisdoc"</sourcexml> and
                            <sourcexml>ci:cite/@type="parallel"</sourcexml>.</ph></p>
            </section>
        </body>
    </dita:topic>

    <!--  @@@ This file has been autogenerated.  Remove this comment after manual development complete! @@@  -->
    <!--    Original DITA file location:  DITA\ConversionInstructions\Rosetta\DITA-UK\UK07-Regulations\head.dita  -->
    
    <xsl:template match="leg:body" >
    <xsl:apply-templates select="@* | node()"/>
    </xsl:template>
        
    <xsl:template match="docinfo:normcite">
        <ref:citations>
            <xsl:for-each select="ci:cite">
                <ref:cite4thisresource>
                    <xsl:choose>
                        <xsl:when test="not(attribute::type)">
                            <xsl:attribute name="citetype" select="'normcite'"/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:attribute name="citetype"
                                select="
                                    if (@type = 'cite4thisdoc') then
                                        'normcite'
                                    else
                                        'parallel'"
                            />
                        </xsl:otherwise>
                    </xsl:choose>
                    <ref:nonciteidentifier normprotocol="unspecified">
                        <xsl:value-of select="ci:content"/>
                    </ref:nonciteidentifier>
                </ref:cite4thisresource>
            </xsl:for-each>
        </ref:citations>

    </xsl:template>


</xsl:stylesheet>

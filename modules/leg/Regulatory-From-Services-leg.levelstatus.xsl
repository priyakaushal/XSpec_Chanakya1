<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:dita="http://dita.oasis-open.org/architecture/2005/" xmlns:leg="http://www.lexis-nexis.com/glp/leg" xmlns:admindoc="urn:x-lexisnexis:content:administrative-document:sharedservices:1" version="2.0" exclude-result-prefixes="dita leg">

	<dita:topic xmlns="http://dita.oasis-open.org/architecture/2005/" id="Regulatory-From-Services-leg.levelstatus">
   <title>leg:levelstatus <lnpid>id-NZ12-24818</lnpid></title>
   <body>
      <section>
        <ul>
        	<li>The conversion for <sourcexml>leg:levelstatus</sourcexml> is based on the following scenarios:
        		<ul>
        			<li>If the <sourcexml>leg:level/leg:level-vrnt/leg:levelinfo/leg:levelstatus[@isrepealed="true"]</sourcexml> with text in that then <b>becomes</b> <targetxml>admindoc:level/admindoc:levelinfo/admindoc:status[@statuscode="repealed"]</targetxml>
        				<note>Include the <targetxml>@statuscode</targetxml> in element <targetxml>admindoc:status</targetxml> to represent final disposition or for a more descriptive status explanation.</note>
        				<pre>
        					<b><i>Example: Source XML 1</i></b>

&lt;leg:level id="SR-2001170-7"&gt;
 &lt;leg:level-vrnt leveltype="clause" searchtype="LEGISLATION CLAUSE" subdoc="true" toc-caption="cl 7 Exemption for public offer of voting securities"&gt;
  &lt;leg:levelinfo&gt;
   &lt;leg:levelstatus isrepealed="true" ln.user-displayed="false"&gt;(Repealed)&lt;/leg:levelstatus&gt;
  &lt;/leg:levelinfo&gt;
  &lt;!--ETC. --&gt;
  &lt;/leg:level-vrnt&gt;
&lt;/leg:level&gt;

        				</pre>
        				<pre>
        					<b><i>Example: Target XML 1</i></b>

&lt;admindoc:level xml:id="SR-2001170-7" alternatetoccaption="cl 7 Exemption for public offer of voting securities" includeintoc="true" leveltype="clause"&gt;
 &lt;admindoc:levelinfo&gt;
  &lt;admindoc:status statuscode="repealed"&gt;(Repealed)&lt;/admindoc:status&gt;
 &lt;/admindoc:levelinfo&gt;
 &lt;!--ETC. --&gt;
&lt;/admindoc:level&gt;

        				</pre>
        			</li>
        			<li>If the <sourcexml>leg:level/leg:levelinfo/leg:levelstatus[@isrepealed="true"]</sourcexml> with no text in that then <b>becomes</b> <targetxml>admindoc:level/admindoc:levelinfo/admindoc:status[@statuscode="repealed"]</targetxml>.
        				<pre>
        					<b><i>Example: Source XML 2</i></b>

&lt;leg:level id="81001-5-2-6"&gt;
 &lt;leg:level-vrnt leveltype="subclause" searchtype="LEGISLATION SUBCLAUSE"&gt;
  &lt;leg:levelinfo&gt;
   &lt;leg:levelstatus isrepealed="true" ln.user-displayed="false"/&gt;
  &lt;/leg:levelinfo&gt;
  &lt;!-- ETC. --&gt;
&lt;/leg:level&gt;

        				</pre>
        				<pre>
        					<b><i>Example: Target XML 2</i></b>

&lt;admindoc:level xml:id="nz_81001-5-2-6" leveltype="subclause"&gt;
 &lt;admindoc:levelinfo&gt;
  &lt;admindoc:status statuscode="repealed"/&gt;
 &lt;/admindoc:levelinfo&gt;
 &lt;!-- ETC. --&gt;
&lt;/admindoc:level&gt;

        				</pre>
        			</li>
        			<li>If the <sourcexml>leg:levelstatus[@isrepealed="false"]</sourcexml> then suppress the element.
        				<pre>
        					<b><i>Example: Source XML 3</i></b>

&lt;leg:level id="HWINSOLV-FORMS-AND-PRECEDENTS-F1-1"&gt;
 &lt;leg:level-vrnt leveltype="form" searchtype="LEGISLATION FORM" subdoc="false" toc-caption="Form 1.1 Deed of Appointment of Receiver"&gt;
  &lt;leg:levelinfo&gt;
   &lt;leg:levelstatus isrepealed="false" ln.user-displayed="false"/&gt;
  &lt;/leg:levelinfo&gt;
  &lt;!-- ETC. --&gt;
&lt;/leg:level&gt;

        				</pre>
        				<pre>
        					<b><i>Example: Target XML 3</i></b>

&lt;admindoc:level xml:id="HWINSOLV-FORMS-AND-PRECEDENTS-F1-1" alternatetoccaption="Form 1.1 Deed of Appointment of Receiver" leveltype="form" includeintoc="true"&gt;
 &lt;!-- ETC. --&gt;
&lt;/admindoc:level&gt;

        				</pre>
        			</li>
        		</ul>
        	</li>
        </ul>
      </section>
   </body>
	</dita:topic>

	<!--  @@@ This file has been autogenerated.  Remove this comment after manual development complete! @@@  -->
	<!--    Original DITA file location:  DITA\ConversionInstructions\Rosetta\DITA-PAC\NZ12_Regulatory_Material_From_Services\Regulatory-From-Services-leg.levelstatus.dita  -->
	
	<xsl:template match="leg:levelinfo">
		<xsl:if test="child::*[not(self::leg:levelstatus[@isrepealed='false'])]">
			<admindoc:levelinfo>
				<xsl:apply-templates select="@* | node()"/>
			</admindoc:levelinfo>
		</xsl:if>		
	</xsl:template>

	<xsl:template match="leg:levelstatus">
		<xsl:if test="@isrepealed='true'">
			<admindoc:status>
				<xsl:apply-templates select="@*"/>
				<xsl:if test="not(@ln.user-displayed='false')">
					<xsl:apply-templates/>
				</xsl:if>
			</admindoc:status>
		</xsl:if>
	</xsl:template>
	
	<xsl:template match="leg:levelstatus/@isrepealed" priority="30">
		<xsl:attribute name="statuscode">repealed</xsl:attribute>
	</xsl:template>
	
	<xsl:template match="leg:levelstatus/@ln.user-displayed"/>
</xsl:stylesheet>
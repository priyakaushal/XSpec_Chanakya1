<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
	xmlns:dita="http://dita.oasis-open.org/architecture/2005/" 
	xmlns:jrnl="http://www.lexis-nexis.com/glp/jrnl" 
	xmlns:docinfo="http://www.lexis-nexis.com/glp/docinfo"
	xmlns:doc="http://www.lexisnexis.com/xmlschemas/content/shared/document-level-metadata/1/"
	xmlns:newsitem="http://www.lexisnexis.com/xmlschemas/content/news/newsitem/1/" 
	version="2.0" exclude-result-prefixes="dita jrnl docinfo newsitem">
	<dita:topic xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/"
		id="Rosetta_docinfo.dpsi-to-LexisAdvance_doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem"
		ditaarch:DITAArchVersion="1.2"
		domains="(topic hi-d)                             (topic ut-d)                             (topic indexing-d)                            (topic hazard-d)                            (topic abbrev-d)                            (topic pr-d)                             (topic sw-d)                            (topic ui-d)                             (topic xml-d)                            (topic ln-d)   "
		class="- topic/topic "
		xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
		xtrc="topic:1;5:65">
		<dita:title class="- topic/title "
			xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
			xtrc="title:1;6:9"><dita:sourcexml class="+ topic/keyword xml-d/sourcexml "
				xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
				xtrc="sourcexml:1;6:20">docinfo:dpsi[@id-string]</dita:sourcexml> to <dita:targetxml
					class="+ topic/keyword xml-d/targetxml "
					xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
					xtrc="targetxml:1;7:15"
					>doc:legacy-metadata[@metadatasource="lbu-meta"]/meta/metaitem</dita:targetxml>
			<dita:lnpid class="+ topic/keyword xml-d/lnpid "
				xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
				xtrc="lnpid:1;7:96">id-CCCC-10296</dita:lnpid></dita:title>
		<dita:body class="- topic/body "
			xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
			xtrc="body:1;8:8">
			<dita:section class="- topic/section "
				xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
				xtrc="section:1;9:12">
				<dita:title class="- topic/title "
					xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
					xtrc="title:2;9:19">Instructions <dita:i class="+ topic/ph hi-d/i "
						xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
						xtrc="i:1;9:35">[common element]</dita:i></dita:title>
				<dita:p class="- topic/p "
					xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
					xtrc="p:1;10:29"><dita:sourcexml class="+ topic/keyword xml-d/sourcexml "
						xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
						xtrc="sourcexml:2;10:40">docinfo:dpsi[@id-string]</dita:sourcexml> becomes <dita:targetxml
							class="+ topic/keyword xml-d/targetxml "
							xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
							xtrc="targetxml:2;11:17"
							>doc:metadata/doc:docinfo/doc:legacy-metadata[@metadatasource="lbu-meta"]/meta/metaitem</dita:targetxml>
					with attributes <dita:targetxml class="+ topic/keyword xml-d/targetxml "
						xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
						xtrc="targetxml:3;12:32">@name="dpsi"</dita:targetxml> and <dita:targetxml
							class="+ topic/keyword xml-d/targetxml "
							xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
							xtrc="targetxml:4;13:17">@value</dita:targetxml> set to <dita:sourcexml
								class="+ topic/keyword xml-d/sourcexml "
								xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
								xtrc="sourcexml:3;13:54">@id-string</dita:sourcexml>. Note that only one <dita:targetxml
									class="+ topic/keyword xml-d/targetxml "
									xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
									xtrc="targetxml:5;14:30">meta</dita:targetxml> is created for the various <dita:targetxml
										class="+ topic/keyword xml-d/targetxml "
										xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
										xtrc="targetxml:6;15:17">metaitem</dita:targetxml> child elements that are created
					while processing <dita:sourcexml class="+ topic/keyword xml-d/sourcexml "
						xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
						xtrc="sourcexml:4;16:17">docinfo</dita:sourcexml> and <dita:sourcexml
							class="+ topic/keyword xml-d/sourcexml "
							xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
							xtrc="sourcexml:5;16:52">docinfo:dpsi</dita:sourcexml>. For more information, see the
					instructions for <dita:xref href="Rosetta_docinfo-LxAdv-doc.metadata_doc.docinfo.dita"
						class="- topic/xref "
						xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
						xtrc="xref:1;18:65" type="topic"
						>docinfo</dita:xref>.</dita:p>
							<dita:note class="- topic/note "
								xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
								xtrc="note:1;19:10"><dita:sourcexml class="+ topic/keyword xml-d/sourcexml "
									xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
									xtrc="sourcexml:6;19:21">@id-string</dita:sourcexml> value is also used in mapping
								for <dita:targetxml class="+ topic/keyword xml-d/targetxml "
									xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
									xtrc="targetxml:7;20:17">docinfo:doc-id</dita:targetxml></dita:note>
							<dita:note class="- topic/note "
								xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
								xtrc="note:2;21:10">If <dita:sourcexml class="+ topic/keyword xml-d/sourcexml "
									xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
									xtrc="sourcexml:7;21:24">docinfo:dpsi[@id-string]</dita:sourcexml> is not present,
								the dpsi value must be captured from one of the following sources: <dita:ul
									class="- topic/ul "
									xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
									xtrc="ul:1;22:61">
									<dita:li class="- topic/li "
										xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
										xtrc="li:1;23:10">The value in <dita:sourcexml
											class="+ topic/keyword xml-d/sourcexml "
											xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
											xtrc="sourcexml:8;24:19"
											>docinfo/docinfo:lbu-meta/docinfo:metaitem[@name="DPSI"]/@value</dita:sourcexml></dita:li>
									<dita:li class="- topic/li "
										xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
										xtrc="li:2;25:10">The LBU manifest file</dita:li>
								</dita:ul></dita:note>
			</dita:section>
			
			<dita:example class="- topic/example "
				xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
				xtrc="example:1;29:12">
				<dita:title class="- topic/title "
					xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
					xtrc="title:3;30:11">Source XML with no attributes on docinfo</dita:title>
				<dita:codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita" xtrc="codeblock:1;31:15">

	&lt;docinfo&gt;
		&lt;docinfo:dpsi id-string="008P"/&gt;
		.................
		.................
	&lt;/docinfo&gt;

	</dita:codeblock>
			</dita:example>
			
			<dita:example class="- topic/example "
				xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
				xtrc="example:2;42:12">
				<dita:title class="- topic/title "
					xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
					xtrc="title:4;43:11">Target XML</dita:title>
				<dita:codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita" xtrc="codeblock:2;44:15">

&lt;doc:docinfo doc-content-country="AU"&gt;
  &lt;doc:legacy-metadata metadatasource="lbu-meta"&gt;
	&lt;meta&gt;
	  &lt;metaitem name="dpsi" value="008P"/&gt;
	&lt;/meta&gt;
  &lt;/doc:legacy-metadata&gt;
	.................
	.................
&lt;/docinfo&gt;

	</dita:codeblock>
			</dita:example>
			
			
			<dita:example class="- topic/example "
				xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
				xtrc="example:3;60:12">
				<dita:title class="- topic/title "
					xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
					xtrc="title:5;61:11">Source XML with an attribute on docinfo</dita:title>
				<dita:codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita" xtrc="codeblock:3;62:15">

    &lt;docinfo partitionnum="2"&gt;
		&lt;docinfo:dpsi id-string="006F"&gt;
		.................
		.................
	&lt;/docinfo&gt;

	</dita:codeblock>
			</dita:example>
			
			<dita:example class="- topic/example "
				xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
				xtrc="example:4;73:12">
				<dita:title class="- topic/title "
					xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
					xtrc="title:6;74:11">Target XML</dita:title>
				<dita:codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita" xtrc="codeblock:4;75:15">

&lt;doc:docinfo doc-content-country="AU"&gt;
  &lt;doc:legacy-metadata metadatasource="lbu-meta"&gt;
	&lt;meta&gt;
		 &lt;metaitem name="partitionnum" value="2"/&gt; 
		&lt;metaitem name="dpsi" value="006F"/&gt;
	&lt;/meta&gt;
  &lt;/doc:legacy-metadata&gt;
	.................
	.................
&lt;/docinfo&gt;


	</dita:codeblock>
			</dita:example>
			
			<dita:section class="- topic/section "
				xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
				xtrc="section:2;92:12">
				<dita:title class="- topic/title "
					xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
					xtrc="title:7;93:11">Changes</dita:title>
				<dita:p class="- topic/p "
					xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
					xtrc="p:2;94:7">2012-12-20: Updated the information on handling the situation when
					<dita:sourcexml class="+ topic/keyword xml-d/sourcexml "
						xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
						xtrc="sourcexml:9;95:17">docinfo:dpsi[@id-string]</dita:sourcexml> is absent with
					instructions to get the dpsi from <dita:sourcexml
						class="+ topic/keyword xml-d/sourcexml "
						xtrf="C:\SVN_View\dataArch\trunk\DITA\ConversionInstructions\Rosetta\common_newest\Rosetta_docinfo.dpsi-LxAdv-doc.legacy-metadata_metadatasource_lbu-meta.meta.metaitem.dita"
						xtrc="sourcexml:10;97:17"
						>docinfo/docinfo:lbu-meta/docinfo:metaitem[@name="DPSI"]/@value</dita:sourcexml> if
					possible.</dita:p>
			</dita:section>
		</dita:body>
	</dita:topic>
	
	<xsl:template match="docinfo:dpsi[@id-string]">
		<metaitem xmlns="http://www.lexisnexis.com/xmlschemas/content/shared/base/1/">
			<xsl:attribute name="name">dpsi</xsl:attribute>
			<xsl:attribute name="value" select="@id-string"/>
		</metaitem>
	</xsl:template>
	
	<!-- docinfo/docinfo:lbu-meta/docinfo:metaitem[@name="DPSI"]/@value -->
	<xsl:template match="docinfo:dpsi[not(@id-string) and ../docinfo:lbu-meta/docinfo:metaitem[@name='DPSI']]">
		<metaitem xmlns="http://www.lexisnexis.com/xmlschemas/content/shared/base/1/">
			<xsl:attribute name="name">dpsi</xsl:attribute>
			<xsl:attribute name="value" select="../docinfo:lbu-meta/docinfo:metaitem[@name='DPSI']/@value"/>
		</metaitem>
	</xsl:template>
</xsl:stylesheet>


